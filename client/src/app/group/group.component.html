<div class="container-fluid">
    <div class="row">
        <!-- Channels (desktop) -->
        <nav class="col-lg-3 col-xl-2 d-none d-lg-block">
            <div class="card shadow-sm border-0 sticky-top">
                <div class="card-body p-0">
                    <div
                        class="px-3 py-2 border-bottom d-flex align-items-center justify-content-between"
                    >
                        <h3
                            class="h6 mb-0 text-uppercase text-muted text-truncate"
                        >
                            {{ groupName }}
                        </h3>

                        <div class="col-auto">
                            <button
                                *ngIf="
                                    user?.roles?.includes('SUPER_ADMIN') ||
                                    (user?.roles?.includes('GROUP_ADMIN') &&
                                        selectedGroup?.ownerUserId === user?.id)
                                "
                                class="btn btn-primary btn-sm"
                                (click)="openNewChannelModal()"
                            >
                                <i class="bi bi-plus-lg"></i>
                            </button>
                        </div>
                    </div>

                    <ul class="list-group list-group-flush small">
                        <li
                            class="list-group-item px-3 py-2"
                            *ngFor="let channel of channels"
                        >
                            <a
                                class="d-flex align-items-center gap-2 text-decoration-none link-body-emphasis"
                                [routerLink]="['channels', channel.id]"
                                routerLinkActive="active"
                            >
                                <i class="bi bi-hash"></i>
                                <span class="text-truncate">{{
                                    channel.name
                                }}</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <!-- Mobile header -->
        <div
            class="d-lg-none py-2 px-3 border-bottom d-flex align-items-center justify-content-between sticky-top bg-body"
        >
            <div class="d-flex align-items-center gap-2">
                <button
                    class="btn btn-outline-secondary btn-sm"
                    data-bs-toggle="offcanvas"
                    data-bs-target="#channelsOffcanvas"
                >
                    <i class="bi bi-list"></i> Channels
                </button>
                <span class="fw-semibold text-truncate">{{ groupName }}</span>
            </div>
        </div>

        <!-- Channel content -->
        <section class="col-12 col-lg-9 col-xl-10">
            <div>
                <div class="card shadow-sm border-0">
                    <div class="card-body">
                        <router-outlet></router-outlet>
                    </div>
                </div>
            </div>
        </section>

        <!-- New Channel Modal -->
        <ng-template #newChannelModal let-modal>
            <div class="modal-header">
                <h5 class="modal-title">Create New Channel</h5>
            </div>
            <div class="modal-body">
                <div class="form-group mb-3">
                    <label for="name" class="mb-2">Channel Name</label>
                    <input
                        type="text"
                        id="name"
                        [(ngModel)]="newChannelName"
                        class="form-control"
                        placeholder="Enter name"
                    />
                </div>

                <button
                    (click)="newChannel(modal)"
                    class="btn btn-primary mt-8"
                >
                    Submit
                </button>
            </div>
        </ng-template>
    </div>
</div>

<!-- Offcanvas: Channels (mobile) -->
<div class="offcanvas offcanvas-start" tabindex="-1" id="channelsOffcanvas">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title">{{ groupName }}</h5>
        <button
            type="button"
            class="btn-close"
            data-bs-dismiss="offcanvas"
            aria-label="Close"
        ></button>
    </div>
    <div class="offcanvas-body p-0">
        <div class="p-3 pt-0">
            <div class="input-group input-group-sm my-3">
                <span class="input-group-text"
                    ><i class="bi bi-search"></i
                ></span>
                <input
                    type="search"
                    class="form-control"
                    placeholder="Find a channelâ€¦"
                />
            </div>
        </div>
        <ul class="list-group list-group-flush">
            <li class="list-group-item" *ngFor="let channel of channels">
                <a
                    class="d-flex align-items-center gap-2 text-decoration-none link-body-emphasis"
                    [routerLink]="[
                        '/dashboard',
                        'group',
                        groupId,
                        'channel',
                        channel.id
                    ]"
                    routerLinkActive="active"
                    data-bs-dismiss="offcanvas"
                >
                    <i class="bi bi-hash"></i>
                    <span class="text-truncate">{{ channel.name }}</span>
                </a>
            </li>
        </ul>
    </div>
</div>
